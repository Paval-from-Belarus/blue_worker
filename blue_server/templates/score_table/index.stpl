<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Lidar Web View</title>
  <link rel="stylesheet" href="css/common.css">

</head>
<body>
  <script src="scripts/common.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/three@latest/build/three.min.js"></script>
  <script>
    function onSelectLidar(select) {
      if (select.value) {
        const lidarId = select.value;
        window.location.href = `lidar?id=${lidarId}`
      }
    }
  </script>
  <% include!("../header.stpl"); %>

  <div class="select-table common-table">
    <div class="select-table__title common-table__title">
      Выберите элемент из списка, чтобы отобразить карту лидара 
    </div>

    <table class="select-table__body common-table__body">
      <div class="form__visible-table">
        <tr>
        </tr>
          <td class="select-table__item common__plain">
        <select onchange="onSelectLidar(this)" class="select-table__selector button-bordered">
          <% if selected_lidar.is_none() { %>
            <option disabled selected value> Select LIDAR </option>
          <% } %>
         <% for lidar_id in scans.keys() { %>
           <% if selected_lidar.is_some() && selected_lidar.unwrap() == *lidar_id {%>
            <option value="<%= *lidar_id %>" selected>LIDAR #<%= *lidar_id %></option>
           <%} else {%>
            <option value="<%= *lidar_id %>">LIDAR #<%= *lidar_id %></option>
           <% } %>
          <% } %>
        </select>

          </td>


    </table>
  </div>

  <% if let Some(lidar_id) = selected_lidar.as_ref() { %>
  <script>
    const LIDAR_ID = <%= *lidar_id %>

    <% include!("points.js"); %>
  </script>

  <% } else { %>
  <% } %>

  <% include!("../footer.stpl"); %>
</body>
</html>
